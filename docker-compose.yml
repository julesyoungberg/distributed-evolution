---
version: '3'

services:
    master:
        build:
            context: ./go
            dockerfile: ./master.Dockerfile
        command: go run main/master/master.go
        environment: 
            HTTP_PORT: 9000
            NUM_WORKERS: 1
            RPC_PORT: 8080
        ports:
            - 9000:9000
            - 8080
    worker:
        build:
            context: ./go
            dockerfile: ./worker.Dockerfile
        command: go run main/worker/worker.go
        environment: 
            PORT: 8080
    ui:
        build:
            context: ./ui
            dockerfile: ./Dockerfile
        command: npm run start:nodemon
        environment: 
            API_URL: localhost:9000
            NODE_ENV: development
            PORT: 3000
        ports:
            - 3000:3000
        restart: unless-stopped
        volumes:
            - ./ui/:/app
            - /app/node_modules/
            - /app/.next

networks:
    default:
        external:
            name: distributed-ga
